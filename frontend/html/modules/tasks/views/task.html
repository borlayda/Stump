<div class="task" ng-controller="TaskController">
    <div class="taskProperties">
        <h1>{{selTask.title}}</h1>
        <div style="float: right; width: 120px;">
            <div ng-class="{'btn-success': selTask.status == 'CLOSED', 'btn-info': selTask.status == 'OPEN', 'btn-warning': selTask.status == 'REOPENED'}">
                <h4 style="padding: 10px;">{{selTask.status}}</h4>
            </div>
            <p>Users on this project:</p>
            <p ng-repeat="user in selTask.users">
                <span>{{user.name}} ({{user.email}}) [{{user.role}}]</span>
            </p>
            <p>Working Time: <input type="text"  ng-model="minute" value="{{selTask.workTime/60}}"/>:<input type="text"  ng-model="second" value="{{selTask.workTime/60}}"/></p>
            <button ng-click="addWorkTime(minute*60+second);" class="btn btn-primary">Add workTime</button>
        </div>
        <div class="description">{{selTask.description}}</div>
        <div>
            <button ng-click="changeTaskStatus('OPEN');" class="btn btn-primary">OPEN</button>
            <button ng-click="changeTaskStatus('CLOSED');" class="btn btn-success">CLOSE</button>
            <button ng-click="changeTaskStatus('REOPENED');" class="btn btn-warning">REOPEN</button>
        </div>
        <h2>{{selTask.title}}'s comments:</h2>
        <div ng-repeat="comment in selTask.comments">
            <div >
                <div class="modal-header bg-info" style="padding: 20px;">
                    <div style="float: left">{{comment.author.name}}:</div>
                    <div style="float: right">{{convertToDate(comment.timestamp);}}</div>
                </div>
                <div class="modal-body">
                    {{comment.text}}
                </div>
            </div>
            <div ng-repeat="subcomment in comment.comments">
                <div class="modal-header bg-info" style="padding: 20px;">
                    <div style="float: left">{{subcomment.author.name}}:</div>
                    <div style="float: right">{{convertToDate(subcomment.timestamp);}}</div>
                </div>
                <div class="modal-body">
                    {{subcomment.text}}
                </div>
            </div>
        </div>
        <a ng-click="showCommentDiv();" ng-if="showAddComment == false">New Comment</a>
        <div class="modal-content" ng-if="showAddComment == true" style="padding: 20px;">
            Name: {{loginUser.name}}<br/>
            Text: <br/><textarea ng-model="text" class="newComment modal-content"></textarea><br/>
            <a ng-click="addComment(selTask.id, text);" style="float:left">Add comment</a>
            <a ng-click="unshowCommentDiv();" style="float: right">Cancel</a>
        </div>
    </div>

</div>